angular.module("ez.dropdown",[]).controller("DropdownCtrl",["$scope","$document","$compile",function(a,b,c){var d,e,f,g=!1,h=function(c){c&&a.clickInside&&f&&f.contains(c.target)?setTimeout(function(){b.one("click",h)}):(a.isOpen=!1,a.$apply())},i=function(){g||(g=!0,c(e)(a.$parent,function(a){f=a[0],d.append(a)})),setTimeout(function(){b.one("click",h)}),d.addClass("open"),"function"==typeof a.onToggle&&a.onToggle(!0)},j=function(){d.removeClass("open"),"function"==typeof a.onToggle&&a.onToggle(!1),b.off("click",h)};this.init=function(b,c){d=b,e=c.clone(),a.$watch("isOpen",function(a,b){a!==b&&(a?i():j())})},this.toggle=function(){a.isOpen=!a.isOpen},a.$on("$destroy",function(){d=e=f=null})}]).directive("dropdown",[function(){return{restrict:"C",controller:"DropdownCtrl",scope:{isOpen:"=?",clickInside:"=?",onToggle:"=?"},compile:function(a){var b=a.find(".dropdown-menu").remove();return function(a,c,d,e){e.init(c,b)}}}}]).directive("dropdownToggle",[function(){return{restrict:"C",require:"^dropdown",link:function(a,b,c,d){b.on("click",function(){d.toggle(),a.$apply()})}}}]);